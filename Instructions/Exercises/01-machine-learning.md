---
lab:
  title: 探索自動化機器學習
---

# 探索自動化機器學習

在此練習中，您將使用自動化機器學習來訓練和評估機器學習模型。 接著，您將部署及測試定型的模型。

> **注意**：此練習旨在引導您完成使用***Azure Machine Learning*** 訓練和測試模型的步驟。 如果您有具有足夠權限的 Azure 訂閱，則可佈建 Azure Machine Learning 工作區，用該工作區進行練習。 不過，Azure Machine Learning 的設計，是針對涉及大量資料和雲端式計算的企業級機器學習解決方案。 Azure Machine Learning 中的部分作業需要佈建計算，而這可能花上一段時間。 如果您沒有 Azure 存取權，或您完成練習的時間有限，則可使用包含此練習中 Azure ML 核心功能的瀏覽器型***ML 實驗室***應用程式，比照 Azure ML 的方式訓練和測試實際的機器學習模型。 雖然 ML 實驗室中的使用者介面與 Azure Machine Learning*不同*，但相似程度極高，足以讓您從 Azure Machine Learning 流暢轉換。 請注意，ML 實驗室應用程式會在瀏覽器中執行，因此只要重新整理頁面，即會重新啟動應用程式！

此練習約需**35** 分鐘完成。如果使用的是瀏覽器型 ML 實驗室應用程式，時間會更短。

## 建立工作區

系統會透過工作區將所有機器學習資源存放在一處，方便您輕鬆從單一位置管理資料、程式碼、模型和其他資產。

1. 開啟您要在此實驗室中使用環境的入口網站，並在系統提示時登入：
    - Azure 型[Azure Machine Learning 工作室](https://ml.azure.com){:target="_blank"}：`https://ml.azure.com`
    - 瀏覽器型[ML 實驗室](https://aka.ms/ml-lab){：target=“_blank”}：`https://aka.ms/ml-lab`

    > **秘訣**：如果 Azure Machine Learning 工作室在現有工作區開啟，請瀏覽至 [所有工作區]**** 頁面。

1. 用適當名稱建立新的工作區。

    如果您使用 Azure Machine Learning，則此練習不會用到*中樞網站*。 根據 Azure 訂閱的任何原則條件約束，選擇適當的進階設定。

1. 建立工作區之後，選取即可檢視**首頁**。

    請注意，工作區有許多頁面，這些頁面會顯示在左側瀏覽窗格中。 您可以使用頂端的 **&#9776;** 功能表展開和折疊此窗格。

## 下載資料

在此練習中，您會使用冰淇淋銷售資料集訓練模型，以便根據季節和氣象特徵，預測指定日子的冰淇淋需求數量。

1. 在新的瀏覽器索引標籤中，從`https://aka.ms/mslearn-ml-data` 將**[ml-data.zip](https://aka.ms/mslearn-ml-data)** 下載至本機電腦。
1. 擷取下載的**ml-data.zip** 封存，查看其中包含的檔案。 請注意，其中的**ice-cream.csv** 檔案包含本練習所需的冰淇淋銷售資料。

## 使用自動化機器學習來定型模型

自動化機器學習可讓您嘗試多個演算法和參數來定型多個模型，並找出適用於資料的最佳演算法和參數。

1. 在入口網站中，檢視 [製作]**** 底下的 [自動化 ML]**** 頁面。

1. 使用下列設定建立新的自動化 ML 作業，並視需要使用 [下一步]**** 來逐步執行使用者介面：

    > **秘訣**：如果下列步驟未提供設定的明確資訊，請使用預設值。

    **基本設定**：

    - 為自動化機器學習工作指派唯一的**工作名稱**

   **工作類型與資料**：

    - 將任務類型設定為**迴歸**。
    - 建立名為**ice-cream** 的新***表格式***資料資產
        - 將本機**ice-cream.csv** 檔案上傳至預設工作區儲存空間。
        - 請<u>只</u>包含下列資料行 (各列的*日期*不重複，且可自行新增預測功能)：
            - **DayOfWeek**
            - **Month**
            - **溫度**
            - **Rainfall**
            - **IceCreamsSold**
        - 建立資料資產。
    - 請先確定已選取新建立的**ice-cream** 資料資產，再進行下個步驟

    > **注意**：如果您不是所使用 Azure 訂閱的系統管理員，系統原則可能不允許使用金鑰存取儲存空間。 若是如此，請要求系統管理員允許使用金鑰型存取，或重新設定 Azure Machine Learning 工作區，以便使用 Entra ID 驗證存取儲存空間。 如果無法這麼做，請使用瀏覽器型***ML 實驗室***應用程式進行此練習。

    **工作設定**：

    - 將**目標資料行** (希望模型預測的標籤) 設定為**IceCreamsSold**。
    - 設定**其他組態設定**：
        - 將 [主要計量]**** 設定為您想用來評估模型效能的計量。 針對此練習，請使用*R<sup>2</sup>* 分數。
        - 選取您要嘗試的模型演算法，或選取所有項目
    - 設定**特徵化設定**：
        - 使用這些設定自訂特徵化 (即資料功能針對模型訓練進行的準備)
    - 設定**限制**：
        - 使用限制，根據特定準則提前結束訓練工作。 針對此練習，請設定下列限制：
            - **計量分數閾值**：0.9
            - **實驗逾時 (分鐘)**：15
        
        > **注意** 使用 Azure Machine Learning 時，請務必設定這些限制，因為執行每個可能演算法和特徵化組合的訓練工作，可能花上好幾個小時！

    **計算**：

    - 使用**無伺服器**計算

    **檢閱**

    - 檢閱設定並仔細檢查， 然後提交訓練工作。 它會自動啟動。

1. 請等候作業完成。

    > **秘訣**：使用 Azure Machine Learning 時可能花上不少時間，不妨喝杯咖啡休息一下！

## 檢閱最佳模型

當自動化機器學習作業完成時，您可以檢閱其定型的最佳模型。

1. 在工作詳細資料頁面的 [概觀]**** 索引標籤中，檢視工作相關資訊，留意最佳模型摘要。
  
1. 選取最佳模型的 [演算法名稱]****，以檢視其詳細資料。 然後在子系工作詳細資料頁面上，檢視下列索引標籤：
    - **概觀**：子系工作的一般詳細資料。
    - **模型**：已訓練模型的相關資訊。
    - **計量** 根據訓練流程使用的測試資料，評估模型的計量和視覺效果。
    - **輸出與記錄**：訓練流程中記錄的資訊。

## 部署和測試模型

1. 在自動化機器學習工作訓練之最佳模型的 [模型]**** 索引標籤中，選取 [部署]****，將模型部署至即時端點。

    針對要執行部署端點的計算，選取適當的**執行個體**和**虛擬機器**選項 (數量視 Azure 訂閱中可用的配額而定)，並指派適當的**端點**和**部署**名稱。

1. 等候部署完成的通知。

    > **秘訣**：在 Azure Machine Learning 工作室中，部署端點可能需要 5-10 分鐘。

## 測試已部署的服務

現在您可以測試已部署的服務。

1. 在導覽功能表中，選取 [端點]**** 頁面，然後開啟您建立的即時端點。

1. 在端點頁面上，檢視 [測試]**** 索引標籤。

1. 在 [輸入資料以測試端點]**** 窗格中，將範本 JSON 換成下列輸入資料：

    ```json
   {
     "input_data": {
        "columns": [
            "DayOfWeek",
            "Month",
            "Temperature",
            "Rainfall"
        ],
        "index": [0],
        "data": [["Wednesday","June",70.5,0.05]]
     }
   }
    ```

1. 按一下 [測試]**** 按鈕。

1. 檢閱測試結果，其中包含根據輸入特徵預測的租賃次數 - 看起來像這樣：

    ```JSON
   [
       120.16208168753236
   ]
    ```

    測試窗格取得輸入資料，並使用您定型的模型，以傳回預測的租賃次數。

## 檢視取用模型的程式碼

現在您有預測模型了，開發人員可以組建取用模型的應用程式。

1. 在即時端點頁面上，檢視 [**取用**] 索引標籤。
1. 請檢閱範例程式碼，取用您的模型。

## 如果還有時間

如果您想進一步實驗自動化機器學習，不妨嘗試使用先前下載之**ml-data.zip** 封存中包含的**penguins.csv** 檔案，訓練**分類**模型。 使用此資料集中的所有資料行。

訓練和部署分類模型之後，即可使用下列 JSON 在端點中進行測試：

```json
{
    "input_data": {
    "columns": [
        "CulmenLength",
        "CulmenDepth",
        "FlipperLength",
        "BodyMass"
    ],
    "index": [0],
    "data": [[45.2,13.8,215,4750]]
    }
}
```

## 清理

如果使用 Azure Machine Learning 完成此練習，請刪除新建立的資源，以免產生不必要的 Azure 用量。

1. 在[Azure Machine Learning 工作室](https://ml.azure.com)的 [**端點**] 索引標籤中，選取您部署的端點。 然後，選取 [刪除]****，並確認您想要刪除該端點。

    刪除您的計算可確保您的訂用帳戶不需支付計算資源的費用。 不過，只要您的訂用帳戶中有 Azure Machine Learning 工作區，您就必須為了資料儲存空間支付少量的費用。 如果您已完成探索 Azure Machine Learning，則可刪除 Azure Machine Learning 工作區及其相關的資源。

若要刪除您的工作區：

1. 在[Azure 入口網站](https://portal.azure.com)的 [資源群組]**** 頁面中，開啟在建立 Azure Machine Learning 工作區時所指定的資源群組。
2. 按一下 [刪除資源群組]****、輸入資源群組名稱以確認要刪除，然後選取 [刪除]****。
